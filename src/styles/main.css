@import "tailwindcss";

/* ===================================
   WESTERN THEME CONFIGURATION
   =================================== */
@theme {
  /* Color Palette - Old West (Light Mode) */
  --color-paper: #f4e4bc;
  --color-paper-dark: #dcbfa3;
  --color-ink: #1a1a1a;
  --color-blood: #8a0303;
  --color-blood-dark: #6b0202;
  --color-leather: #5d4037;
  --color-leather-light: #8d6e63;
  --color-faded: #5c5c5c;
  --color-highlight: #3e2723;
  --color-gold: #d4a017;
  --color-rust: #b7410e;
  
  /* Typography */
  --font-western: 'Rye', serif;
  --font-typewriter: 'Special Elite', monospace;
  --font-mono: 'Courier Prime', monospace;
  
  /* Shadows */
  --shadow-paper: 0 15px 40px rgba(0,0,0,0.6), inset 0 0 80px rgba(93, 64, 55, 0.2);
  --shadow-stamp: 2px 2px 4px rgba(0,0,0,0.3);
  
  /* Animations */
  --animate-dust: dust 8s linear infinite;
}

/* ===================================
   DARK MODE - Midnight Campfire Theme
   =================================== */
:root {
  /* Higher contrast dark palette */
  --dm-paper: #1e2024;
  --dm-paper-dark: #14161a;
  --dm-ink: #f0ebe3;
  --dm-blood: #c44040;
  --dm-leather: #464647;
  --dm-leather-light: #555658;
  --dm-faded: #b0b0b0;
  --dm-highlight: #282c32;
  --dm-gold: #e8b84a;
  --dm-ember: #d4533b;
}

/* Dark mode class toggle */
body.dark-mode {
  --color-paper: var(--dm-paper);
  --color-paper-dark: var(--dm-paper-dark);
  --color-ink: var(--dm-ink);
  --color-blood: var(--dm-blood);
  --color-leather: var(--dm-leather);
  --color-leather-light: var(--dm-leather-light);
  --color-faded: var(--dm-faded);
  --color-highlight: var(--dm-highlight);
  --color-gold: var(--dm-gold);
  --color-rust: var(--dm-ember);
}

/* Dark mode specific overrides */
body.dark-mode {
  background-color: #08090a;
  background-image: 
    radial-gradient(ellipse at 80% 20%, rgba(212, 83, 59, 0.04) 0%, transparent 50%),
    radial-gradient(ellipse at 20% 80%, rgba(232, 184, 74, 0.02) 0%, transparent 40%);
}

body.dark-mode .container {
  background-color: var(--dm-paper);
  border-color: var(--dm-leather);
  box-shadow: 0 15px 50px rgba(0,0,0,0.8), 
              inset 0 0 60px rgba(212, 83, 59, 0.03),
              0 0 100px rgba(0,0,0,0.5);
}

body.dark-mode .container::after {
  border-left-color: var(--dm-leather);
}

body.dark-mode .checklist-item input[type="checkbox"] {
  border-color: #666;
  background: #1a1c20;
}

body.dark-mode .checklist-item input[type="checkbox"]:checked {
  background-color: var(--dm-ink);
  box-shadow: 0 0 0 3px var(--dm-paper), 0 0 0 5px var(--dm-blood);
}

/* Dark mode text fixes for readability */
body.dark-mode .checklist-item {
  color: #e8e0d5;
}

body.dark-mode .checklist-item .item-text {
  color: #e8e0d5;
}

body.dark-mode .checklist-item:hover {
  color: #ffb4a8;
}

body.dark-mode .tip {
  color: #b0a090;
}

body.dark-mode .section-header {
  color: #e07050;
  background: linear-gradient(90deg, rgba(179,58,58,0.15), transparent);
  border-bottom-color: #444;
}

body.dark-mode .section-header:hover {
  color: #ff9080;
}

/* Nav sidebar text in dark mode */
body.dark-mode .nav-category-title {
  color: #d0c8bc;
}

body.dark-mode .nav-category-header:hover .nav-category-title {
  color: #fff;
}

body.dark-mode .nav-section-title {
  color: #c0b8ac;
}

body.dark-mode .nav-section-link:hover .nav-section-title {
  color: #fff;
}

body.dark-mode .nav-section-count {
  color: #888;
}

body.dark-mode .journal-section {
  background: repeating-linear-gradient(
    var(--dm-paper), 
    var(--dm-paper) 30px, 
    #1d1f24 31px
  );
}

body.dark-mode .nav-sidebar {
  background: linear-gradient(180deg, #1e2024 0%, #14161a 100%);
  border-right: 1px solid #333;
}

body.dark-mode .nav-fab {
  background: linear-gradient(135deg, #c44040 0%, #8a2020 100%);
  border-color: #f0ebe3;
}

body.dark-mode .particle {
  background: #e8b84a;
  box-shadow: 0 0 4px #e8b84a;
}

body.dark-mode ::-webkit-scrollbar-track {
  background: var(--dm-paper-dark);
}

body.dark-mode ::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, #555658 0%, #3a3c40 100%);
  border-color: var(--dm-paper-dark);
}

/* ===================================
   THEME TOGGLE BUTTON
   =================================== */
.theme-toggle {
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 100;
  width: 48px;
  height: 48px;
  border-radius: 50%;
  border: 2px solid var(--color-leather);
  background: linear-gradient(135deg, var(--color-paper) 0%, var(--color-paper-dark) 100%);
  color: var(--color-ink);
  font-size: 1.3rem;
  cursor: pointer;
  box-shadow: 0 4px 15px rgba(0,0,0,0.3),
              inset 0 -2px 0 rgba(0,0,0,0.1);
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  line-height: 1;
}

.theme-toggle:hover {
  transform: scale(1.1) rotate(15deg);
  box-shadow: 0 6px 25px rgba(0,0,0,0.4);
}

.theme-toggle:active {
  transform: scale(0.95);
}

body.dark-mode .theme-toggle {
  background: linear-gradient(135deg, #2a2d32 0%, #1a1c20 100%);
  border-color: var(--dm-gold);
  box-shadow: 0 4px 15px rgba(0,0,0,0.5),
              0 0 15px rgba(232,184,74,0.15),
              inset 0 -2px 0 rgba(0,0,0,0.2);
}

body.dark-mode .theme-toggle:hover {
  box-shadow: 0 6px 30px rgba(0,0,0,0.6),
              0 0 25px rgba(232,184,74,0.25);
}
/* ===================================
   KEYFRAME ANIMATIONS
   =================================== */
@keyframes dust {
  0% { 
    transform: translateY(0) translateX(0); 
    opacity: 0; 
  }
  20% { 
    opacity: 0.6; 
  }
  80% { 
    opacity: 0.4; 
  }
  100% { 
    transform: translateY(-120px) translateX(60px); 
    opacity: 0; 
  }
}

@keyframes flicker {
  0%, 100% { opacity: 0.7; }
  50% { opacity: 0.9; }
}

@keyframes stamp-appear {
  0% { 
    transform: rotate(15deg) scale(1.5);
    opacity: 0;
  }
  100% { 
    transform: rotate(15deg) scale(1);
    opacity: 0.7;
  }
}

/* ===================================
   CUSTOM SCROLLBAR (Western Theme)
   =================================== */
::-webkit-scrollbar {
  width: 12px;
  height: 12px;
}

::-webkit-scrollbar-track {
  background: var(--color-paper-dark);
  border-left: 1px solid var(--color-faded);
}

::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, var(--color-leather) 0%, var(--color-highlight) 100%);
  border-radius: 6px;
  border: 2px solid var(--color-paper-dark);
}

::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(180deg, var(--color-leather-light) 0%, var(--color-leather) 100%);
}

::-webkit-scrollbar-corner {
  background: var(--color-paper-dark);
}

/* Firefox scrollbar */
* {
  scrollbar-width: thin;
  scrollbar-color: var(--color-leather) var(--color-paper-dark);
}

/* ===================================
   BASE STYLES
   =================================== */
body {
  @apply bg-paper-dark min-h-screen m-0 p-5 flex justify-center;
  background-image: url("https://www.transparenttextures.com/patterns/aged-paper.png");
  font-family: var(--font-typewriter);
  color: var(--color-ink);
}

/* ===================================
   CONTAINER
   =================================== */
.container {
  @apply w-full max-w-4xl relative z-10 p-8 md:p-12;
  background-color: var(--color-paper);
  box-shadow: var(--shadow-paper);
  border: 1px solid var(--color-faded);
}

.container::after {
  content: "";
  @apply absolute top-0 bottom-0 left-4;
  width: 2px;
  border-left: 2px dashed var(--color-faded);
}

/* ===================================
   PARTICLES
   =================================== */
.particle {
  @apply fixed pointer-events-none z-0;
  width: 3px;
  height: 3px;
  background: #6b5a4e;
  border-radius: 50%;
}

/* ===================================
   TYPOGRAPHY
   =================================== */
.title-main {
  @apply text-center uppercase tracking-wider pb-5 mb-1;
  font-family: var(--font-western);
  font-size: clamp(2rem, 6vw, 3.8rem);
  text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
  border-bottom: 3px double var(--color-ink);
  letter-spacing: 4px;
}

.subtitle {
  @apply text-center italic mb-10;
  font-family: var(--font-mono);
  font-size: 1.1rem;
  color: var(--color-leather);
}

/* ===================================
   SECTION HEADERS
   =================================== */
.section-header {
  @apply flex justify-between items-center cursor-pointer select-none mt-12 pb-1;
  font-family: var(--font-western);
  font-size: 1.8rem;
  color: var(--color-blood);
  border-bottom: 1px solid var(--color-faded);
  background: linear-gradient(90deg, rgba(138,3,3,0.05), transparent);
  transition: color 0.2s ease;
}

.section-header:hover {
  color: var(--color-highlight);
}

.section-header::after {
  content: "‚ñº";
  @apply mr-2;
  font-size: 1rem;
  color: var(--color-faded);
  transition: transform 0.3s ease;
}

.section-header.collapsed::after {
  content: "‚ñ≤";
}

.section-header .progress-badge {
  font-size: 0.875rem;
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  margin-right: 1rem;
  font-family: var(--font-mono);
  background: rgba(138,3,3,0.1);
  color: var(--color-blood);
}

/* Section title group for reward tag placement */
.section-title-group {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  flex-wrap: wrap;
}

.section-title-text {
  white-space: nowrap;
}

/* Section-level reward tag */
.section-reward-tag {
  font-size: 0.7rem;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-family: var(--font-mono);
  font-weight: normal;
  background: linear-gradient(90deg, rgba(212,160,23,0.2), rgba(212,160,23,0.1));
  color: var(--color-gold);
  border: 1px solid rgba(212,160,23,0.3);
}

body.dark-mode .section-reward-tag {
  color: var(--dm-gold);
  background: linear-gradient(90deg, rgba(232,184,74,0.2), rgba(232,184,74,0.1));
  border-color: rgba(232,184,74,0.3);
}

/* Section Info Bar - for section-level tip_detailed */
.section-info-bar {
  margin-bottom: 1rem;
  padding: 0.5rem 0;
}

.section-info-btn {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 0.75rem;
  font-family: var(--font-mono);
  font-size: 0.8rem;
  color: var(--color-leather);
  background: linear-gradient(90deg, rgba(93,64,55,0.08), transparent);
  border: 1px dashed var(--color-leather);
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.section-info-btn:hover {
  background: linear-gradient(90deg, rgba(93,64,55,0.15), rgba(93,64,55,0.05));
  color: var(--color-blood);
  border-color: var(--color-blood);
}

.section-info-btn.expanded {
  background: linear-gradient(90deg, rgba(93,64,55,0.12), transparent);
  border-style: solid;
}

body.dark-mode .section-info-btn {
  color: #b0a090;
  background: linear-gradient(90deg, rgba(255,255,255,0.05), transparent);
  border-color: #555;
}

body.dark-mode .section-info-btn:hover {
  background: linear-gradient(90deg, rgba(255,255,255,0.1), transparent);
  color: var(--dm-blood);
  border-color: var(--dm-blood);
}

.section-tip-detailed {
  margin-top: 0.75rem;
  padding: 1rem;
  font-family: var(--font-mono);
  font-size: 0.9rem;
  line-height: 1.6;
  color: var(--color-ink);
  background: linear-gradient(135deg, rgba(244,228,188,0.5), rgba(220,191,163,0.3));
  border-left: 3px solid var(--color-gold);
  border-radius: 0 6px 6px 0;
  box-shadow: inset 0 0 15px rgba(93,64,55,0.08);
}

.section-tip-detailed.hidden {
  display: none;
}

body.dark-mode .section-tip-detailed {
  background: linear-gradient(135deg, rgba(30,32,36,0.8), rgba(20,22,26,0.6));
  border-left-color: var(--dm-gold);
  color: var(--dm-ink);
}

/* ===================================
   CHECKLIST GROUPS
   =================================== */
.checklist-group {
  @apply mb-8;
  transition: max-height 0.3s ease-out, opacity 0.2s ease;
}

.checklist-group.hidden {
  @apply hidden;
}

/* ===================================
   CHECKLIST ITEMS - NEW LAYOUT
   =================================== */

/* Wrapper for each item (contains row + tip + detailed + subitems) */
.item-wrapper {
  margin-bottom: 0.5rem;
}

/* Wrapper for sub-items (same as item-wrapper but with smaller margin) */
.sub-item-wrapper {
  margin-bottom: 0.25rem;
}

/* Main row: checkbox + text + tags + more info button */
.item-row {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  flex-wrap: nowrap;
  min-height: 36px;
  padding: 4px 0;
}

/* Tags container - flexible, wraps on smaller screens */
.item-tags {
  display: flex;
  align-items: center;
  gap: 0.25rem;
  flex-wrap: wrap;
  flex-shrink: 0;
}

/* Inline More Info button (emoji style) */
.more-info-btn-inline {
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 32px;
  width: 32px;
  min-height: 32px;
  height: 32px;
  padding: 0;
  margin: 0;
  margin-left: auto;
  background: linear-gradient(135deg, rgba(93,64,55,0.1), transparent);
  border: 1px solid var(--color-leather-light);
  border-radius: 50%;
  cursor: pointer;
  font-size: 1rem;
  line-height: 1;
  text-align: center;
  vertical-align: middle;
  opacity: 0.7;
  transition: all 0.2s ease;
  flex-shrink: 0;
  box-sizing: border-box;
}

.more-info-btn-inline:hover {
  opacity: 1;
  background: linear-gradient(135deg, rgba(93,64,55,0.2), rgba(93,64,55,0.05));
  border-color: var(--color-blood);
  transform: scale(1.1);
}

.more-info-btn-inline.expanded {
  opacity: 1;
  background: linear-gradient(135deg, rgba(212,160,23,0.2), rgba(212,160,23,0.1));
  border-color: var(--color-gold);
}

body.dark-mode .more-info-btn-inline {
  background: linear-gradient(135deg, rgba(255,255,255,0.05), transparent);
  border-color: #555;
}

body.dark-mode .more-info-btn-inline:hover {
  background: linear-gradient(135deg, rgba(255,255,255,0.12), rgba(255,255,255,0.03));
  border-color: var(--dm-blood);
}

body.dark-mode .more-info-btn-inline.expanded {
  background: linear-gradient(135deg, rgba(232,184,74,0.15), rgba(232,184,74,0.05));
  border-color: var(--dm-gold);
}

/* ===================================
   CHECKLIST ITEMS
   =================================== */
.checklist-item {
  display: flex;
  align-items: center;
  padding: 0.25rem 0;
  cursor: pointer;
  font-size: 1.2rem;
  line-height: 1.4;
  font-weight: bold;
  color: var(--color-highlight);
  transition: color 0.2s ease;
  flex-shrink: 1;
  min-width: 0;
}

.checklist-item:hover {
  color: var(--color-blood);
}

.checklist-item input[type="checkbox"] {
  @apply mr-4 cursor-pointer;
  appearance: none;
  -webkit-appearance: none;
  min-width: 24px;
  width: 24px;
  height: 24px;
  border: 2px solid var(--color-ink);
  border-radius: 50%;
  background-color: transparent;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  margin-top: 2px;
}

.checklist-item input[type="checkbox"]:checked {
  background-color: var(--color-ink);
  box-shadow: 0 0 0 3px var(--color-paper), 0 0 0 5px var(--color-blood);
}

.checklist-item input[type="checkbox"]:checked::after {
  content: "‚úñ";
  color: var(--color-paper);
  font-size: 12px;
  font-weight: bold;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
  line-height: 1;
}

.checklist-item .item-text.completed {
  text-decoration: line-through;
  opacity: 0.5;
  text-decoration-thickness: 3px;
  text-decoration-color: var(--color-blood);
}

.checklist-item .item-text .missable-tag {
  @apply ml-2 px-2 py-0.5 text-xs rounded;
  background: var(--color-rust);
  color: white;
  font-family: var(--font-mono);
}

.checklist-item .item-text .chapter-tag {
  @apply ml-2 px-2 py-0.5 text-xs rounded;
  background: var(--color-leather);
  color: white;
  font-family: var(--font-mono);
}

/* ===================================
   TIPS
   =================================== */
.tip {
  @apply block ml-11 mb-4 mt-0.5 italic;
  font-family: var(--font-mono);
  font-size: 1rem;
  color: var(--color-faded);
  line-height: 1.4;
}

/* ===================================
   MORE INFO BUTTON & TIP DETAILED
   Cowboy Storyteller Narrative Display
   =================================== */
.more-info-btn {
  @apply ml-11 mb-2 px-3 py-1.5 cursor-pointer flex items-center gap-2;
  font-family: var(--font-mono);
  font-size: 0.85rem;
  color: var(--color-leather);
  background: linear-gradient(90deg, rgba(93,64,55,0.1), transparent);
  border: 1px dashed var(--color-leather);
  border-radius: 4px;
  transition: all 0.2s ease;
}

.more-info-btn:hover {
  background: linear-gradient(90deg, rgba(93,64,55,0.2), rgba(93,64,55,0.05));
  color: var(--color-blood);
  border-color: var(--color-blood);
}

.more-info-btn.expanded {
  background: linear-gradient(90deg, rgba(93,64,55,0.15), transparent);
  border-style: solid;
}

.more-info-icon {
  font-size: 0.7rem;
  color: var(--color-faded);
  transition: transform 0.2s ease;
}

.more-info-btn.expanded .more-info-icon {
  color: var(--color-blood);
}

/* Tip Detailed - The Campfire Narrative Box */
.tip-detailed {
  @apply ml-11 mb-4 p-4 rounded;
  font-family: var(--font-mono);
  font-size: 0.95rem;
  line-height: 1.7;
  color: var(--color-ink);
  background: linear-gradient(135deg, rgba(244,228,188,0.6), rgba(220,191,163,0.4));
  border-left: 3px solid var(--color-gold);
  border-radius: 0 8px 8px 0;
  box-shadow: inset 0 0 20px rgba(93,64,55,0.1),
              0 2px 8px rgba(0,0,0,0.1);
  position: relative;
}

.tip-detailed::before {
  content: "üî•";
  position: absolute;
  top: -8px;
  left: -8px;
  font-size: 1rem;
  opacity: 0.8;
}

.tip-detailed-content {
  white-space: pre-line;
}

/* Inline formatting within tip-detailed */
.tip-detailed-content strong {
  color: var(--color-gold);
  font-weight: 600;
}

.tip-detailed-content em {
  color: var(--color-faded);
  font-style: italic;
}

body.dark-mode .tip-detailed-content strong {
  color: var(--dm-gold);
}

body.dark-mode .tip-detailed-content em {
  color: #b0a090;
}

.tip-detailed.hidden {
  @apply hidden;
}

/* Sub-item variations */
.sub-more-info {
  @apply ml-8;
  font-size: 0.8rem;
}

.sub-tip-detailed {
  @apply ml-8 p-3;
  font-size: 0.9rem;
}

/* Dark mode - More Info */
body.dark-mode .more-info-btn {
  color: #b0a090;
  background: linear-gradient(90deg, rgba(255,255,255,0.05), transparent);
  border-color: #555;
}

body.dark-mode .more-info-btn:hover {
  background: linear-gradient(90deg, rgba(255,255,255,0.1), transparent);
  color: var(--dm-blood);
  border-color: var(--dm-blood);
}

body.dark-mode .tip-detailed {
  background: linear-gradient(135deg, rgba(30,32,36,0.9), rgba(20,22,26,0.8));
  border-left-color: var(--dm-gold);
  color: var(--dm-ink);
  box-shadow: inset 0 0 30px rgba(232,184,74,0.05),
              0 2px 12px rgba(0,0,0,0.3);
}

body.dark-mode .tip-detailed::before {
  filter: brightness(1.2);
}

/* ===================================
   REWARD TAGS
   Money: üí∞ green, Items: üèÜ gold
   =================================== */
.checklist-item .item-text .reward-tag {
  @apply ml-2 px-2 py-0.5 text-xs rounded;
  font-family: var(--font-mono);
  font-weight: normal;
}

/* Item rewards - Trophy gold */
.checklist-item .item-text .reward-item {
  background: linear-gradient(135deg, var(--color-gold), #b8860b);
  color: white;
}

/* Money rewards - Dollar green */
.checklist-item .item-text .reward-money {
  background: linear-gradient(135deg, #2e7d32, #1b5e20);
  color: #c8e6c9;
  text-shadow: 0 1px 2px rgba(0,0,0,0.3);
}

/* Dark mode adjustments */
body.dark-mode .reward-item {
  background: linear-gradient(135deg, var(--dm-gold), #9a7b0a);
}

body.dark-mode .reward-money {
  background: linear-gradient(135deg, #388e3c, #2e7d32);
  color: #a5d6a7;
}


/* ===================================
   SUB-ITEMS (Nested Checklists)
   =================================== */
.sub-items-container {
  @apply ml-11 mb-4 mt-2;
  border-left: 2px solid var(--color-leather);
  padding-left: 12px;
  background: linear-gradient(90deg, rgba(93,64,55,0.05), transparent);
  border-radius: 0 4px 4px 0;
}

.sub-items-header {
  @apply flex items-center gap-2 py-1 px-2 cursor-pointer select-none rounded;
  font-family: var(--font-mono);
  font-size: 0.85rem;
  color: var(--color-leather);
  background: rgba(93,64,55,0.1);
  transition: all 0.2s ease;
}

.sub-items-header:hover {
  background: rgba(93,64,55,0.2);
  color: var(--color-blood);
}

.sub-toggle-icon {
  font-size: 0.7rem;
  color: var(--color-faded);
}

.sub-progress {
  font-size: 0.75rem;
  color: var(--color-faded);
  font-weight: 600;
}

/* Progress Bar */
.sub-progress-bar {
  flex: 1;
  max-width: 120px;
  height: 6px;
  background: rgba(0,0,0,0.3);
  border-radius: 3px;
  overflow: hidden;
  margin-left: 12px;
}

.sub-progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--color-gold), var(--color-leather));
  border-radius: 3px;
  transition: width 0.3s ease;
}

.sub-progress-fill.complete {
  background: linear-gradient(90deg, #4ade80, #22c55e);
  box-shadow: 0 0 8px rgba(74, 222, 128, 0.5);
}

/* All complete state */
.sub-items-container.all-complete {
  border-left-color: #22c55e;
  background: linear-gradient(90deg, rgba(34,197,94,0.1), transparent);
}

.sub-items-container.all-complete .sub-items-header {
  background: rgba(34,197,94,0.15);
}

body.dark-mode .sub-progress-bar {
  background: rgba(255,255,255,0.1);
}

body.dark-mode .sub-items-container.all-complete {
  border-left-color: #4ade80;
  background: linear-gradient(90deg, rgba(74,222,128,0.1), transparent);
}

.sub-items-list {
  @apply mt-2;
  transition: all 0.3s ease;
}

.sub-items-list.hidden {
  @apply hidden;
}

/* Sub-item styling */
.checklist-item.sub-item {
  @apply py-0.5;
  font-size: 1rem;
  font-weight: normal;
}

.checklist-item.sub-item input[type="checkbox"] {
  min-width: 18px;
  width: 18px;
  height: 18px;
  margin-right: 10px;
}

.checklist-item.sub-item input[type="checkbox"]:checked::after {
  font-size: 10px;
}

.tip.sub-tip {
  @apply ml-8 mb-2;
  font-size: 0.9rem;
}

/* Parent item with subitems indicator */
.checklist-item.has-subitems .item-text::after {
  content: "üìã";
  @apply ml-2;
  font-size: 0.9rem;
}

/* Dark mode sub-items */
body.dark-mode .sub-items-container {
  border-left-color: #555;
  background: linear-gradient(90deg, rgba(255,255,255,0.02), transparent);
}

body.dark-mode .sub-items-header {
  background: rgba(255,255,255,0.05);
  color: #b0a090;
}

body.dark-mode .sub-items-header:hover {
  background: rgba(255,255,255,0.1);
  color: var(--dm-blood);
}

body.dark-mode .checklist-item.sub-item {
  color: #c0b8ac;
}

body.dark-mode .tip.sub-tip {
  color: #888;
}

/* ===================================
   JOURNAL
   =================================== */
.journal-section {
  @apply mt-12 p-5;
  background: repeating-linear-gradient(var(--color-paper), var(--color-paper) 30px, #94aca7 31px);
  border: 1px solid var(--color-faded);
  box-shadow: inset 0 0 20px rgba(0,0,0,0.05);
}

.journal-section textarea {
  @apply w-full bg-transparent border-none outline-none resize-y pl-2;
  font-family: var(--font-mono);
  font-weight: bold;
  font-size: 1.1rem;
  line-height: 31px;
  height: 200px;
  color: var(--color-ink);
}

/* ===================================
   BUTTONS
   =================================== */
.btn-burn {
  @apply block mx-auto mt-16 mb-5 px-9 py-3 bg-transparent cursor-pointer;
  font-family: var(--font-western);
  font-size: 1.2rem;
  border: 2px solid var(--color-blood);
  color: var(--color-blood);
  transition: all 0.3s ease;
}

.btn-burn:hover {
  background: var(--color-blood);
  color: var(--color-paper);
}

.btn-export {
  @apply block mx-auto mt-4 px-6 py-2 bg-transparent cursor-pointer;
  font-family: var(--font-mono);
  font-size: 0.9rem;
  border: 1px solid var(--color-leather);
  color: var(--color-leather);
  transition: all 0.3s ease;
}

.btn-export:hover {
  background: var(--color-leather);
  color: var(--color-paper);
}

/* ===================================
   STAMP
   =================================== */
.stamp {
  @apply absolute px-3 py-2 pointer-events-none;
  top: 40px;
  right: 40px;
  border: 4px double var(--color-blood);
  color: var(--color-blood);
  font-family: var(--font-typewriter);
  font-weight: bold;
  font-size: 1rem;
  transform: rotate(15deg);
  opacity: 0.7;
  animation: stamp-appear 0.5s ease-out;
}

/* ===================================
   PLAYLIST LINKS
   =================================== */
.playlist-links {
  @apply text-center mb-8;
  font-size: 0.9rem;
}

.playlist-links a {
  @apply mx-2 no-underline;
  color: var(--color-leather);
  border-bottom: 1px dashed var(--color-leather);
  transition: color 0.2s ease;
}

.playlist-links a:hover {
  color: var(--color-blood);
}

/* ===================================
   PROGRESS BAR
   =================================== */
.progress-container {
  @apply w-full h-2 mt-4 mb-8 rounded overflow-hidden;
  background: rgba(0,0,0,0.1);
}

.progress-bar {
  @apply h-full rounded transition-all duration-500;
  background: linear-gradient(90deg, var(--color-blood), var(--color-rust));
}

.progress-text {
  @apply text-center mb-2;
  font-family: var(--font-mono);
  font-size: 0.9rem;
  color: var(--color-faded);
}

/* ===================================
   NAVIGATION SIDEBAR (Enhanced)
   =================================== */
.nav-sidebar {
  @apply fixed left-0 top-0 h-full z-50 flex flex-col;
  width: 260px;
  background: linear-gradient(180deg, var(--color-leather) 0%, var(--color-highlight) 100%);
  box-shadow: 4px 0 20px rgba(0,0,0,0.5);
  transform: translateX(-100%);
  transition: transform 0.3s ease;
}

.nav-sidebar.open {
  transform: translateX(0);
}

.nav-header {
  @apply flex justify-between items-center p-4 pb-3;
  border-bottom: 2px solid rgba(244,228,188,0.2);
}

.nav-title {
  font-family: var(--font-western);
  color: var(--color-blood);
  font-size: 1.3rem;  
}

.nav-close {
  @apply w-8 h-8 flex items-center justify-center cursor-pointer rounded;
  background: rgba(138,3,3,0.5);
  color: var(--color-paper);
  border: 1px solid rgba(244,228,188,0.3);
  font-size: 1rem;
  transition: all 0.2s ease;
}

.nav-close:hover {
  background: var(--color-blood);
}

/* Search Bar */
.nav-search {
  @apply p-3 pb-2;
}

.nav-search-input {
  @apply w-full py-2 px-3 rounded;
  background: rgba(0,0,0,0.3);
  border: 1px solid rgba(244,228,188,0.2);
  color: var(--color-paper);
  font-family: var(--font-mono);
  font-size: 0.85rem;
  outline: none;
  transition: all 0.2s ease;
}

.nav-search-input::placeholder {
  color: rgba(244,228,188,0.5);
}

.nav-search-input:focus {
  border-color: var(--color-gold);
  background: rgba(0,0,0,0.4);
}

/* Categories Container */
.nav-categories {
  @apply flex-1 overflow-y-auto p-2;
}

/* Category Groups */
.nav-category {
  @apply mb-2;
}

.nav-category.hidden {
  @apply hidden;
}

.nav-category-header {
  @apply flex items-center py-2 px-3 cursor-pointer rounded;
  color: var(--color-paper);
  font-family: var(--font-western);
  font-size: 1rem;
  transition: all 0.2s ease;
}

.nav-category-header:hover {
  background: rgba(244,228,188,0.1);
}

.nav-category-icon {
  @apply mr-2;
  font-size: 1.1rem;
}

.nav-category-title {
  @apply flex-1;
}

.nav-category-arrow {
  font-size: 0.7rem;
  color: rgba(244,228,188,0.5);
  transition: transform 0.2s ease;
}

/* Collapsible Section Items */
.nav-category-items {
  @apply pl-4 overflow-hidden;
  max-height: 500px;
  transition: max-height 0.3s ease, opacity 0.2s ease;
}

.nav-category-items.collapsed {
  max-height: 0;
  opacity: 0;
}

/* Section Links */
.nav-section-link {
  @apply flex items-center py-1.5 px-3 rounded no-underline mb-0.5;
  color: rgba(244,228,188,0.8);
  font-family: var(--font-typewriter);
  font-size: 0.8rem;
  transition: all 0.2s ease;
}

.nav-section-link:hover {
  background: rgba(244,228,188,0.1);
  color: var(--color-paper);
}

.nav-section-link.active {
  background: rgba(138,3,3,0.4);
  color: var(--color-paper);
  border-left: 3px solid var(--color-blood);
}

.nav-section-link.hidden {
  @apply hidden;
}

.nav-section-icon {
  @apply mr-2;
  font-size: 0.9rem;
}

.nav-section-title {
  @apply flex-1 truncate;
}

.nav-section-count {
  font-size: 0.7rem;
  background: rgba(0,0,0,0.3);
  color: rgba(244,228,188,0.6);
  padding: 1px 6px;
  border-radius: 8px;
  font-family: var(--font-mono);
}

.nav-section-count.has-progress {
  background: rgba(218,165,32,0.3);
  color: var(--color-gold);
}

/* Completed section styling */
.nav-section-link.section-complete {
  background: rgba(34,197,94,0.15);
}

.nav-section-link.section-complete .nav-section-count {
  background: rgba(34,197,94,0.4);
  color: #4ade80;
}

.nav-section-link.section-complete .nav-section-title {
  text-decoration: line-through;
  opacity: 0.7;
}

/* Nav Stats Footer */
.nav-stats {
  @apply p-3;
  border-top: 1px solid rgba(244,228,188,0.2);
}

.nav-stats-bar {
  @apply h-2 rounded overflow-hidden mb-1;
  background: rgba(0,0,0,0.3);
}

.nav-stats-fill {
  @apply h-full rounded transition-all duration-300;
  background: linear-gradient(90deg, var(--color-gold), var(--color-rust));
}

.nav-stats-text {
  @apply block text-center;
  font-family: var(--font-mono);
  font-size: 0.75rem;
  color: rgba(244,228,188,0.7);
}

/* Floating Action Button */
.nav-fab {
  @apply fixed z-50 flex items-center justify-center cursor-pointer;
  bottom: 20px;
  left: 20px;
  width: 56px;
  height: 56px;
  background: linear-gradient(135deg, var(--color-blood) 0%, var(--color-blood-dark) 100%);
  color: var(--color-paper);
  border: 2px solid var(--color-paper);
  border-radius: 50%;
  font-size: 1.4rem;
  line-height: 1;
  padding: 0;
  box-shadow: 0 4px 20px rgba(0,0,0,0.4);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.nav-fab:hover {
  transform: scale(1.1);
  box-shadow: 0 6px 25px rgba(0,0,0,0.5);
}

/* Section header highlight when navigating */
.section-header.nav-highlight {
  background: linear-gradient(90deg, rgba(212,160,23,0.2), transparent);
  animation: highlight-pulse 1.5s ease-out;
}

@keyframes highlight-pulse {
  0%, 100% { background: linear-gradient(90deg, rgba(138,3,3,0.05), transparent); }
  50% { background: linear-gradient(90deg, rgba(212,160,23,0.3), transparent); }
}

/* Search Hidden Items */
.search-hidden {
  @apply hidden;
}

/* Filter Hidden Items */
.filter-hidden {
  @apply hidden;
}

/* ============================================
   Smart Filters UI - Toggle Panel
   ============================================ */

/* Search row with toggle button */
.nav-search-row {
  display: flex;
  gap: 0.5rem;
  padding: 0.5rem 0.75rem;
  border-bottom: 1px solid rgba(244,228,188,0.15);
}

.nav-search-row .nav-search-input {
  flex: 1;
}

.filter-toggle-btn {
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(0,0,0,0.2);
  border: 1px solid rgba(244,228,188,0.2);
  border-radius: 6px;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.2s ease;
}

.filter-toggle-btn:hover {
  background: rgba(0,0,0,0.35);
  border-color: var(--color-gold);
}

.filter-toggle-btn.active {
  background: linear-gradient(135deg, var(--color-blood) 0%, var(--color-blood-dark) 100%);
  border-color: var(--color-blood);
}

/* Collapsible filters panel */
.nav-filters-panel {
  padding: 0.75rem;
  border-bottom: 1px solid rgba(244,228,188,0.15);
  background: rgba(0,0,0,0.1);
  animation: slideDown 0.2s ease;
}

.nav-filters-panel.hidden {
  display: none;
}

@keyframes slideDown {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Filter sections */
.filter-section {
  margin-bottom: 0.75rem;
}

.filter-section:last-child {
  margin-bottom: 0;
}

.filter-section-label {
  font-size: 0.65rem;
  font-family: var(--font-mono);
  color: rgba(244,228,188,0.5);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 0.35rem;
}

/* Filter chips */
.filter-chips {
  display: flex;
  flex-wrap: wrap;
  gap: 0.35rem;
}

.filter-chip {
  padding: 0.3rem 0.5rem;
  font-size: 0.7rem;
  font-family: var(--font-mono);
  background: rgba(0,0,0,0.2);
  color: rgba(244,228,188,0.7);
  border: 1px solid rgba(244,228,188,0.15);
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.15s ease;
  white-space: nowrap;
}

.filter-chip:hover {
  background: rgba(0,0,0,0.35);
  border-color: var(--color-gold);
  color: var(--color-paper);
}

.filter-chip.active {
  background: linear-gradient(135deg, var(--color-blood) 0%, var(--color-blood-dark) 100%);
  border-color: var(--color-blood);
  color: var(--color-paper);
}

.filter-empty {
  font-size: 0.7rem;
  color: rgba(244,228,188,0.4);
  font-style: italic;
}

/* Radio button group for status */
.filter-radio-group {
  display: flex;
  gap: 0;
  border: 1px solid rgba(244,228,188,0.2);
  border-radius: 4px;
  overflow: hidden;
}

.filter-radio {
  flex: 1;
  padding: 0.35rem 0.5rem;
  text-align: center;
  font-size: 0.7rem;
  font-family: var(--font-mono);
  background: rgba(0,0,0,0.2);
  color: rgba(244,228,188,0.6);
  cursor: pointer;
  transition: all 0.15s ease;
  border-right: 1px solid rgba(244,228,188,0.1);
}

.filter-radio:last-child {
  border-right: none;
}

.filter-radio:hover {
  background: rgba(0,0,0,0.35);
  color: var(--color-paper);
}

.filter-radio.active {
  background: linear-gradient(135deg, var(--color-blood) 0%, var(--color-blood-dark) 100%);
  color: var(--color-paper);
}

/* Active filter badges row */
.filter-active-row {
  display: flex;
  flex-wrap: wrap;
  gap: 0.35rem;
  margin-top: 0.5rem;
  padding-top: 0.5rem;
  border-top: 1px solid rgba(244,228,188,0.1);
}

.filter-active-row:empty {
  display: none;
}

.filter-badge {
  display: inline-flex;
  align-items: center;
  gap: 0.25rem;
  padding: 0.2rem 0.5rem;
  font-size: 0.65rem;
  font-family: var(--font-mono);
  background: rgba(212,160,23,0.2);
  color: var(--color-gold);
  border: 1px solid var(--color-gold);
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.filter-badge:hover {
  background: var(--color-gold);
  color: var(--color-leather);
}

.filter-clear-all {
  padding: 0.2rem 0.5rem;
  font-size: 0.65rem;
  font-family: var(--font-mono);
  background: transparent;
  color: rgba(244,228,188,0.6);
  border: 1px solid rgba(244,228,188,0.2);
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.filter-clear-all:hover {
  border-color: var(--color-blood);
  color: var(--color-blood);
}

/* Dark mode filter styles */
body.dark-mode .nav-search-row {
  border-bottom-color: rgba(255,255,255,0.1);
}

body.dark-mode .filter-toggle-btn {
  background: rgba(0,0,0,0.3);
  border-color: rgba(255,255,255,0.1);
}

body.dark-mode .nav-filters-panel {
  background: rgba(0,0,0,0.2);
  border-bottom-color: rgba(255,255,255,0.1);
}

body.dark-mode .filter-chip {
  background: rgba(0,0,0,0.3);
  border-color: rgba(255,255,255,0.1);
  color: rgba(255,255,255,0.6);
}

body.dark-mode .filter-chip:hover {
  background: rgba(0,0,0,0.45);
  color: #fff;
}

body.dark-mode .filter-radio {
  background: rgba(0,0,0,0.3);
  border-color: rgba(255,255,255,0.1);
  color: rgba(255,255,255,0.5);
}

body.dark-mode .filter-radio:hover {
  color: #fff;
}

body.dark-mode .filter-badge {
  background: rgba(212,160,23,0.15);
  border-color: rgba(212,160,23,0.5);
}

/* Desktop: Show sidebar inline */
@media (min-width: 1200px) {
  .nav-sidebar {
    transform: translateX(0);
    position: fixed;
  }
  
  .nav-fab {
    @apply hidden;
  }
  
  body {
    padding-left: 280px;
  }
}

/* ===================================
   RESPONSIVE
   =================================== */
@media (max-width: 640px) {
  .container {
    @apply p-4;
  }
  
  .section-header {
    @apply text-xl;
  }
  
  .checklist-item {
    @apply text-base;
  }
  
  .stamp {
    @apply hidden;
  }
}

/* ===================================
   INTERACTIVE MAP
   =================================== */
.map-fab {
  @apply fixed z-50 flex items-center justify-center cursor-pointer;
  bottom: 20px;
  right: 20px;
  width: 56px;
  height: 56px;
  background: linear-gradient(135deg, #228b22 0%, #155015 100%);
  color: white;
  border: 2px solid #f4e4bc;
  border-radius: 50%;
  font-size: 1.4rem;
  line-height: 1;
  padding: 0;
  box-shadow: 0 4px 20px rgba(0,0,0,0.4);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.map-fab:hover {
  transform: scale(1.1);
  box-shadow: 0 6px 25px rgba(0,0,0,0.5);
}

body.dark-mode .map-fab {
  background: linear-gradient(135deg, #2d8e2d 0%, #1a5f1a 100%);
  border-color: #f0ebe3;
}

/* Map Modal */
.map-modal {
  @apply fixed inset-0 z-[100] flex flex-col;
  background: #1a1a1a;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s ease, visibility 0.3s ease;
}

.map-modal.open {
  opacity: 1;
  visibility: visible;
}

.map-header {
  @apply flex items-center justify-between px-6 py-4;
  background: linear-gradient(180deg, #2d2218 0%, #1a1410 100%);
  border-bottom: 2px solid #8a4a20;
}

.map-title {
  font-family: var(--font-western);
  color: #f4e4bc;
  font-size: 1.8rem;
  margin: 0;
}

.map-controls {
  @apply flex gap-2;
}

.map-filter-btn {
  @apply px-3 py-1.5 rounded cursor-pointer transition-all;
  background: rgba(244,228,188,0.1);
  border: 1px solid rgba(244,228,188,0.3);
  color: #f4e4bc;
  font-family: var(--font-mono);
  font-size: 0.75rem;
}

.map-filter-btn:hover {
  background: rgba(244,228,188,0.2);
}

.map-filter-btn.active {
  background: #8a0303;
  border-color: #f4e4bc;
}

.map-close {
  @apply w-10 h-10 flex items-center justify-center cursor-pointer rounded;
  background: rgba(138,3,3,0.7);
  color: #f4e4bc;
  border: 1px solid rgba(244,228,188,0.3);
  font-size: 1.2rem;
  transition: all 0.2s ease;
}

.map-close:hover {
  background: #8a0303;
}

.map-container {
  @apply flex-1;
  background: #d4c4a8;
}

/* Leaflet overrides */
.leaflet-container {
  background: #d4c4a8 !important;
  font-family: var(--font-body) !important;
}

.leaflet-popup-content-wrapper {
  background: #f4e4bc !important;
  border: 2px solid #8b7355 !important;
  border-radius: 4px !important;
  box-shadow: 0 4px 15px rgba(0,0,0,0.3) !important;
}

.leaflet-popup-content {
  margin: 12px !important;
  color: #3d2b1f !important;
  font-size: 14px !important;
}

.leaflet-popup-tip {
  background: #f4e4bc !important;
  border-left: 1px solid #8b7355 !important;
  border-bottom: 1px solid #8b7355 !important;
}

.map-popup strong {
  display: block;
  font-family: var(--font-western);
  color: #8a0303;
  font-size: 1.1rem;
  margin-bottom: 4px;
}

.map-popup p {
  margin: 6px 0;
  font-size: 0.85rem;
  color: #5d4037;
}

.popup-category {
  display: block;
  font-size: 0.75rem;
  color: #8b7355;
  margin-top: 8px;
  padding-top: 6px;
  border-top: 1px dashed #ccc;
}

.popup-completed {
  display: inline-block;
  margin-top: 6px;
  padding: 2px 8px;
  background: #228b22;
  color: white;
  font-size: 0.7rem;
  border-radius: 3px;
}

/* Map Legend */
.map-legend {
  @apply flex flex-wrap gap-4 px-6 py-3;
  background: #1a1410;
  border-top: 1px solid #8a4a20;
}

.legend-item {
  @apply flex items-center gap-2;
  font-size: 0.8rem;
  color: #f4e4bc;
}

.legend-color {
  @apply w-4 h-4 rounded-full;
  border: 1px solid rgba(255,255,255,0.3);
}

.legend-icon {
  font-size: 0.9rem;
}

.legend-label {
  font-family: var(--font-mono);
}

/* Custom marker styles */
.custom-marker {
  background: transparent !important;
  border: none !important;
}

.filtered-out {
  pointer-events: none;
}

/* Mobile adjustments for map */
@media (max-width: 768px) {
  .map-controls {
    @apply hidden;
  }
  
  .map-title {
    font-size: 1.3rem;
  }
  
  .map-legend {
    @apply flex-wrap gap-2 px-3 py-2;
  }
  
  .legend-label {
    @apply hidden;
  }
}
